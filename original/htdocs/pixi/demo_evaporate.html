<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>PIXI DEMO</title>
    <style>
        body {
          text-align: center;
          font-size: 24px;
          color: red;
          overflow: hidden;
          background-color: #272727;
        }
    </style>
    <link rel="stylesheet" href="../bower_components/katex/dist/katex.min.css">
    <script src="../bower_components/katex/dist/katex.min.js"></script>
</head>

<body>

    <div id="appPanel"></div>
    <div id="container"></div>
    <script src="../js/stats.min.js"></script>
    <script src="../js/dat.gui.min.js"></script>
    <!-- // <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> -->
    <!-- // <script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/1.5.3/pixi.js"></script> -->
    <script src="../js/TweenMax.min.js"></script>
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../bower_components/pixi/bin/pixi.min.js"></script>
    <!-- // <script src="js/jquery.mobile-1.4.5.min.js"></script> -->
    <!-- // <script src="../js/konva.min.js"></script> -->
    <script src="../js/ui.js"></script>
    <!-- // <script src="../js/math.js"></script> -->
    <!-- // <script src="js/ui.js"></script> -->
    <!-- // <script src="js/slider.js"></script> -->
    <!-- // <script src="js/button.js"></script> -->
    <script defer="defer">

//==============================================================================
//                                  START
//==============================================================================

// ///////////////////////////////////////////////////////////////
// Particls
// ///////////////////////////////////////////////////////////////
var ParticlesView = function() {
  this.init();
};

var ParticlesViewProto = ParticlesView.prototype;

ParticlesViewProto.init = function() {
  this.particleHolder = [];

  this
    .setupHandlers()
    .layout()
    .render();
};

ParticlesViewProto.setupHandlers = function() {
  this.onRefreshHandler = this.onRefresh.bind(this);
  return this;
};

ParticlesViewProto.layout = function() {
  this.stage = document.createElement('canvas');
  this.stage.id = 'stage';
  this.stage.width = window.innerWidth;
  this.stage.height = window.innerHeight;
  document.body.appendChild(this.stage);
  this.centerX = this.stage.width / 2;
  this.centerY = this.stage.height / 2;
  this.context = this.stage.getContext('2d');
  this.offset = this.stage.height * 0.4;

  return this;
};

ParticlesViewProto.render = function() {
  window.requestAnimationFrame(this.onRefreshHandler);
};

ParticlesViewProto.onRefresh = function() {
  this.update();
  this.createNew();
  this.draw();
  window.requestAnimationFrame(this.onRefreshHandler);
};

ParticlesViewProto.update = function() {
  var i = 0;
  var l = this.particleHolder.length;
  for (; i < l; i++) {
    var particle = this.particleHolder[i];

    if (particle.r < 1 || particle.x > this.stage.width || particle.y > this.stage.height) {
      particle.x = this.centerX;
      particle.y = this.centerY;
      particle.r = 10;
    } else {
      particle.x += particle.vx;
      particle.y += particle.vy;
      particle.r -= 0.06;
    }

  }
};

ParticlesViewProto.createNew = function() {
  if (this.particleHolder.length > 2000) {
    return;
  }
  particleConf = {
    x: this.centerX,
    y: this.centerY,
    vx: (Math.random() * 2) - 1,
    vy: (Math.random() * 2) - 1,
    r: 10,
    angle: .0001
  };

  this.particleHolder.push(particleConf);
};

ParticlesViewProto.draw = function() {
  this.context.clearRect(0, 0, this.stage.width, this.stage.height);
  var i = 0;
  var l = this.particleHolder.length;
  for (; i < l; i++) {
    var particle = this.particleHolder[i];
    this.context.fillStyle = "rgb(223, 15, 255)";
    this.context.beginPath();
    this.context.arc(particle.x, particle.y, particle.r, 0, Math.PI * 2, false);
    this.context.fill();
  }
};

var particles = new ParticlesView();

    </script>

</body>

</html>